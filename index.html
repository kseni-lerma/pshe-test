<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ПШЭ Трекер - Учет штатных единиц</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Шапка -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fas fa-chart-line"></i>
                <h1>ПШЭ Трекер</h1>
            </div>
            <nav class="nav">
                <button class="nav-btn active" data-page="interface">
                    <i class="fas fa-tasks"></i> Распределение ПШЭ
                </button>
                <button class="nav-btn" data-page="data">
                    <i class="fas fa-database"></i> База данных
                </button>
                <button class="nav-btn" data-page="report">
                    <i class="fas fa-chart-bar"></i> Годовой отчет
                </button>
            </nav>
            <div class="user-info">
                <span class="username" id="current-user">Сидоров С.С.</span>
                <button class="btn btn-small" id="save-all-btn">
                    <i class="fas fa-save"></i> Сохранить все
                </button>
            </div>
        </div>
    </header>

    <!-- Статус бар -->
    <div class="status-bar">
        <div class="container">
            <span id="status-message">Готов к работе</span>
            <div class="status-controls">
                <button class="btn btn-small" id="help-btn">
                    <i class="fas fa-question-circle"></i> Справка
                </button>
            </div>
        </div>
    </div>

    <main class="container">
        <!-- Страница: Распределение ПШЭ -->
        <div id="interface-page" class="page active">
            <div class="page-header">
                <h2><i class="fas fa-tasks"></i> Распределение ПШЭ за 2025 год</h2>
                <div class="controls">
                    <div class="select-group">
                        <label for="department-select">Отдел:</label>
                        <select id="department-select" class="form-select">
                            <option value="Отдел 1">Отдел 1</option>
                            <option value="Отдел 2">Отдел 2</option>
                        </select>
                    </div>
                    <div class="select-group">
                        <label for="month-select">Месяц:</label>
                        <select id="month-select" class="form-select">
                            <option value="01">Январь 2025 (17 раб. дн.)</option>
                            <option value="02">Февраль 2025 (19 раб. дн.)</option>
                            <option value="03">Март 2025 (20 раб. дн.)</option>
                            <option value="04">Апрель 2025 (22 раб. дн.)</option>
                            <option value="05">Май 2025 (18 раб. дн.)</option>
                            <option value="06">Июнь 2025 (21 раб. дн.)</option>
                            <option value="07">Июль 2025 (23 раб. дн.)</option>
                            <option value="08">Август 2025 (21 раб. дн.)</option>
                            <option value="09">Сентябрь 2025 (22 раб. дн.)</option>
                            <option value="10">Октябрь 2025 (23 раб. дн.)</option>
                            <option value="11">Ноябрь 2025 (18 раб. дн.)</option>
                            <option value="12">Декабрь 2025 (22 раб. дн.)</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary" id="copy-prev-btn">
                        <i class="fas fa-copy"></i> Копировать из прошлого месяца
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>Распределение ПШЭ сотрудников по бизнес-процессам</h3>
                    <div class="info-badge">
                        <i class="fas fa-info-circle"></i> Сумма по каждому сотруднику должна быть 1.0 (100%)
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="data-table" id="distribution-table">
                        <thead>
                            <tr>
                                <th>№</th>
                                <th>Сотрудник</th>
                                <th>Табельный номер</th>
                                <th>Статус</th>
                                <th>Отпуск/больничный/увольнение</th>
                                <th>Рабочих дней</th>
                                <th>Доступно дней</th>
                                <th id="bp1-header">BP01</th>
                                <th id="bp2-header">BP02</th>
                                <th id="bp3-header">BP03</th>
                                <th>Сумма</th>
                                <th>Проверка</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="distribution-body">
                            <!-- Данные загружаются через JS -->
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="7"><strong>ИТОГО по отделу:</strong></td>
                                <td id="total-bp1">0.0</td>
                                <td id="total-bp2">0.0</td>
                                <td id="total-bp3">0.0</td>
                                <td id="total-sum">0.0</td>
                                <td colspan="2">
                                    <div class="validation-status" id="validation-status">
                                        <i class="fas fa-check-circle valid"></i> Все проверки пройдены
                                    </div>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <div class="card-footer">
                    <button class="btn btn-success" id="save-distribution-btn">
                        <i class="fas fa-check"></i> Сохранить распределение
                    </button>
                    <div class="formula-info">
                        <strong>Формула расчета:</strong> Факт ПШЭ = Доля × (Доступно дней / Рабочих дней)
                    </div>
                </div>
            </div>
        </div>

        <!-- Страница: База данных -->
        <div id="data-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-database"></i> Управление данными</h2>
                <div class="tabs" id="data-tabs">
                    <button class="tab-btn active" data-tab="employees">Сотрудники</button>
                    <button class="tab-btn" data-tab="absences">Отпуска и больничные</button>
                    <button class="tab-btn" data-tab="bps">Бизнес-процессы</button>
                    <button class="tab-btn" data-tab="departments">Отделы и БП</button>
                    <button class="tab-btn" data-tab="pshe-data">Данные ПШЭ</button>
                </div>
            </div>

            <div class="tab-content active" id="employees-tab">
                <div class="card">
                    <div class="card-header">
                        <h3>Сотрудники</h3>
                        <button class="btn btn-primary" id="add-employee-btn">
                            <i class="fas fa-plus"></i> Добавить сотрудника
                        </button>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="employees-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>ФИО</th>
                                    <th>Отдел</th>
                                    <th>Должность</th>
                                    <th>Дата приема</th>
                                    <th>Дата увольнения</th>
                                    <th>Статус</th>
                                    <th>Руководитель</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="employees-body">
                                <!-- Данные загружаются через JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="absences-tab">
                <div class="card">
                    <div class="card-header">
                        <h3>Отпуска и больничные</h3>
                        <button class="btn btn-primary" id="add-absence-btn">
                            <i class="fas fa-plus"></i> Добавить отсутствие
                        </button>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="absences-data-table">
                            <thead>
                                <tr>
                                    <th>Сотрудник</th>
                                    <th>Дата начала</th>
                                    <th>Дата завершения</th>
                                    <th>Тип отсутствия</th>
                                    <th>Дней</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="absences-body">
                                <!-- Данные загружаются через JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="bps-tab">
                <div class="card">
                    <div class="card-header">
                        <h3>Бизнес-процессы</h3>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="bps-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Наименование</th>
                                    <th>Отделы, в которых используется</th>
                                </tr>
                            </thead>
                            <tbody id="bps-body">
                                <!-- Данные загружаются через JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="departments-tab">
                <div class="card">
                    <div class="card-header">
                        <h3>Привязка бизнес-процессов к отделам</h3>
                        <div class="info-badge">
                            <i class="fas fa-info-circle"></i> Выберите БП, которые ведет ваш отдел
                        </div>
                    </div>
                    <div class="form-section">
                        <div class="select-group">
                            <label for="dept-bp-select">Отдел:</label>
                            <select id="dept-bp-select" class="form-select">
                                <option value="Отдел 1">Отдел 1</option>
                                <option value="Отдел 2">Отдел 2</option>
                            </select>
                        </div>
                    </div>
                    <div class="bp-selection">
                        <div class="bp-list" id="bp-list">
                            <!-- БП загружаются через JS -->
                        </div>
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-success" id="save-dept-bp-btn">
                            <i class="fas fa-save"></i> Сохранить привязку
                        </button>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="pshe-data-tab">
                <div class="card">
                    <div class="card-header">
                        <h3>Данные ПШЭ</h3>
                        <button class="btn btn-warning" id="clear-pshe-btn">
                            <i class="fas fa-trash"></i> Очистить все данные ПШЭ
                        </button>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="pshe-data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Сотрудник</th>
                                    <th>Отдел</th>
                                    <th>Месяц</th>
                                    <th>Данные распределения</th>
                                    <th>Дата сохранения</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="pshe-data-body">
                                <!-- Данные загружаются через JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Страница: Годовой отчет -->
        <div id="report-page" class="page">
            <div class="page-header">
                <h2><i class="fas fa-chart-bar"></i> Годовой отчет по ПШЭ за 2025 год</h2>
                <div class="controls">
                    <div class="select-group">
                        <label for="report-dept-select">Отдел:</label>
                        <select id="report-dept-select" class="form-select">
                            <option value="Отдел 1">Отдел 1</option>
                            <option value="Отдел 2">Отдел 2</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" id="generate-report-btn">
                        <i class="fas fa-chart-line"></i> Сгенерировать отчет
                    </button>
                    <button class="btn btn-secondary" id="print-report-btn">
                        <i class="fas fa-print"></i> Печать отчета
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>Сводка по бизнес-процессам</h3>
                </div>
                <div class="table-container">
                    <table class="data-table" id="annual-report-table">
                        <thead>
                            <tr>
                                <th>Бизнес-процесс</th>
                                <th>Янв</th><th>Фев</th><th>Мар</th><th>Апр</th>
                                <th>Май</th><th>Июн</th><th>Июл</th><th>Авг</th>
                                <th>Сен</th><th>Окт</th><th>Ноя</th><th>Дек</th>
                                <th>Среднее за год</th>
                            </tr>
                        </thead>
                        <tbody id="annual-report-body">
                            <!-- Данные загружаются через JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Модальные окна -->
    <div id="add-employee-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Добавить нового сотрудника</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="employee-form">
                    <div class="form-group">
                        <label>Табельный номер:</label>
                        <input type="text" class="form-control" id="emp-id" placeholder="EMP010" required>
                    </div>
                    <div class="form-group">
                        <label>ФИО:</label>
                        <input type="text" class="form-control" id="emp-name" placeholder="Иванов Иван Иванович" required>
                    </div>
                    <div class="form-group">
                        <label>Отдел:</label>
                        <select class="form-control" id="emp-dept" required>
                            <option value="Отдел 1">Отдел 1</option>
                            <option value="Отдел 2">Отдел 2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Должность:</label>
                        <input type="text" class="form-control" id="emp-position" placeholder="Специалист" required>
                    </div>
                    <div class="form-group">
                        <label>Дата приема:</label>
                        <input type="date" class="form-control" id="emp-hire-date" value="2025-01-01" required>
                    </div>
                    <div class="form-group">
                        <label>Руководитель:</label>
                        <select class="form-control" id="emp-manager">
                            <option value="">Не указан</option>
                            <option value="Петров П.П.">Петров П.П.</option>
                            <option value="Сидоров С.С.">Сидоров С.С.</option>
                            <option value="Новиков Н.Н.">Новиков Н.Н.</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Отмена</button>
                <button class="btn btn-primary" id="save-employee-btn">Сохранить</button>
            </div>
        </div>
    </div>

    <div id="add-absence-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Добавить отсутствие</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="absence-form">
                    <div class="form-group">
                        <label>Сотрудник:</label>
                        <select class="form-control" id="absence-emp-id" required>
                            <!-- Заполняется через JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Тип отсутствия:</label>
                        <select class="form-control" id="absence-type" required>
                            <option value="Отпуск">Отпуск</option>
                            <option value="Больничный">Больничный</option>
                            <option value="Командировка">Командировка</option>
                            <option value="Учебный отпуск">Учебный отпуск</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Дата начала:</label>
                        <input type="date" class="form-control" id="absence-start" value="2025-01-01" required>
                    </div>
                    <div class="form-group">
                        <label>Дата завершения:</label>
                        <input type="date" class="form-control" id="absence-end" value="2025-01-05" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Отмена</button>
                <button class="btn btn-primary" id="save-absence-btn">Сохранить</button>
            </div>
        </div>
    </div>

    <div id="help-modal" class="modal">
        <div class="modal-content wide">
            <div class="modal-header">
                <h3>Справка по использованию ПШЭ Трекера</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="help-content">
                    <h4>Основные принципы:</h4>
                    <ol>
                        <li>Каждый сотрудник имеет 1.0 ПШЭ (100% рабочего времени)</li>
                        <li>ПШЭ распределяется между бизнес-процессами (БП), которые ведет отдел</li>
                        <li>Сумма по всем БП для одного сотрудника = 1.0</li>
                        <li>Учитывайте отпуска и больничные при расчете доступных дней</li>
                    </ol>
                    
                    <h4>Как работать с системой:</h4>
                    <p><strong>Шаг 1:</strong> На странице "База данных" → "Отделы и БП" выберите БП для вашего отдела</p>
                    <p><strong>Шаг 2:</strong> На главной странице выберите отдел и месяц для заполнения</p>
                    <p><strong>Шаг 3:</strong> Для каждого сотрудника укажите доступные дни и распределите по БП</p>
                    <p><strong>Шаг 4:</strong> Нажмите "Сохранить распределение"</p>
                    <p><strong>Шаг 5:</strong> После заполнения всех месяцев смотрите годовой отчет</p>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>